<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0&icon_names=editdelete_foreverarrow_drop_downmysterysaveaddcancel" />

<div class="mt-5 text-center">
    <h2 class="fonte fonte-preta">Administrar times</h2>
</div>
<div class="custom-container h-50 overflow-auto">
    <div class="container-fluid mt-5 mb-5">
        <table class="table table-hover table-bordered border-color justify-content-center text-center">
            <thead>
                <tr>
                    <th scope="col" class="cor fonte">Nome</th>
                    <th scope="col" class="col-4 cor fonte">Tipo de esporte</th>
                    <th scope="col" class="cor fonte">Presidente</th>
                    <th scope="col" class="cor btn botao-adicionar"><span class="material-symbols-outlined"
                            (click)="openModalNewTime()">
                            add
                        </span></th>
                </tr>
            </thead>
            <tbody>
                @for(time of listaTimes; track time.id){
                <tr>
                    <td class="cor">{{time.nome}}</td>
                    <td class="cor">{{time.tipoEsporte}}</td>
                    <td class="cor">{{time.presidente?.nome}}</td>
                    <td class="cor icones">
                        <!--
                        <button type="button" class="btn botao-excluir"><span class="material-symbols-outlined icone">
                                delete_forever
                            </span></button> -->
                        <button type="button" class="btn botao-aumentar" (click)="openModal(time)"><span
                                class="material-symbols-outlined">
                                mystery
                            </span></button>
                    </td>
                </tr>

                }
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" #modalRef data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-xl modal-xl-custom">
        <div class="aumentar-tamanho">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="staticBackdropLabel">
                        <div class="fonte fonte-preta">Detalhes</div>
                    </h1>
                    <button type="button" class="btn-close" (click)="closeModal()"></button>
                </div>
                <div class="modal-body modal-body-scrollable">
                    <div class="container custom d-flex">
                        <div class="row custom">
                            <!-- data-bs-spy="scroll" data-bs-smooth-scroll="true" -->
                            <div class="col-3 border-end">
                                <p><strong>Cód:</strong> {{selectedTime.id}}</p>
                                <p><strong>Nome:</strong> {{selectedTime.nome}}</p>
                                <p><strong>Presidente:</strong> {{selectedTime.presidente?.nome}}</p>
                                <p><strong>Tipo de esporte:</strong> {{selectedTime.tipoEsporte}}</p>
                                <button type="button" class="btn botao-editar m-1"><span
                                        class="material-symbols-outlined" (click)="openModalEditTime(selectedTime)">
                                        edit
                                    </span></button>
                                <button type="button" class="btn botao-excluir m-1"><span
                                        class="material-symbols-outlined" (click)="delete(selectedTime.id)">
                                        delete_forever
                                    </span></button>
                            </div>
                            <div class="col-4 border-end ">
                                <h5 class="fonte fonte-preta">Jogadores:</h5>
                                <hr>
                                <div class="h-50 overflow-auto">
                                    @for(jogador of selectedTime.jogadores; track jogador.id){
                                    <div>
                                        <p><strong>Nome:</strong></p>
                                        <p>{{jogador.nome}}</p>
                                        <p><strong>Cód:</strong></p>
                                        <p>{{jogador.id}}</p>
                                    </div>
                                    <hr>
                                    }
                                </div>
                            </div>
                            <div class="col-4 border-end overflow-auto">
                                <h5 class="fonte fonte-preta">Reservas:</h5>
                                <hr>
                                <div class="h-50 overflow-auto">
                                    @for(reserva of selectedTime.reservas; track reserva.id){
                                    <div>
                                        <p><strong>Horario:</strong></p>
                                        <p>{{reserva.horario?.horario}}</p>
                                        <p><strong>Cód:</strong></p>
                                        <p>{{reserva.id}}</p>
                                        <p><strong>Quadra:</strong></p>
                                        <p>{{reserva.quadra?.nome}}</p>
                                    </div>
                                    <hr>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" (click)="closeModal()">Fechar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal novo usuário -->
<div class="modal fade" id="staticBackdrop" #modalRefNewTime data-bs-backdrop="static" data-bs-keyboard="false"
    tabindex="-1">
    <div class="modal-dialog modal-l">
        <div class="condensar">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="staticBackdropLabel">
                        <div class="fonte fonte-preta">Adicionar novo time</div>
                    </h1>
                </div>
                <div class="m-2">
                    <label for="nome" class="form-label">Nome</label>
                    <input type="text" class="form-control" id="nome" [(ngModel)]="newTime!.nome">
                </div>
                <div class="m-2">
                    <label for="presidente" class="form-label">Presidente</label>
                    <select class="form-select" [(ngModel)]="newTime!.presidente">
                        @for(usuario of listaUsuarios; track usuario.id){
                        <option [ngValue]="usuario">{{usuario.nome}}</option>
                        }
                    </select>
                </div>
                <div class="m-2">
                    <label for="nome" class="form-label">Tipo de esporte</label>
                    <select class="form-select" [(ngModel)]="newTime!.tipoEsporte">
                        <option selected value="POLIESPORTIVA">Poliesportiva</option>
                        <option value="BASQUETE">Basquete</option>
                        <option value="FUTSAL">Futsal</option>
                        <option value="VOLEI">Volei</option>
                        <option value="TENIS">Tenis</option>
                        <option value="HANDEBOL">Handebol</option>
                        <option value="AREIA">Areia</option>
                        <option value="SOCIETY">Society</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn botao-cancelar" (click)="closeModalNewTime()"><span
                            class="material-symbols-outlined ">
                            cancel
                        </span></button>

                    <button type="button" class="btn botao-salvar"><span class="material-symbols-outlined icone"
                            (click)="saveTime(newTime!)">
                            save
                        </span></button>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Modal editar usuário -->
<div class="modal fade" id="staticBackdrop" #ModalRefEditTime data-bs-backdrop="static" data-bs-keyboard="false"
    tabindex="-1">
    <div class="modal-dialog modal-l">
        <div class="aumentar-tamanho">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="staticBackdropLabel">
                        <div class="fonte fonte-preta">Editar time</div>
                    </h1>
                    <button type="button" class="btn-close" (click)="closeModalEditTime(true)"></button>
                </div>
                <div class="modal-body modal-body-scrollable h-25 overflow-auto">
                    <div class="container custom d-flex">
                        <div class="row custom-sm ">
                            <!-- data-bs-spy="scroll" data-bs-smooth-scroll="true" -->
                            <div class="mb=3">
                                <label class="form-label">Presidente</label>
                                <p class="mb-2 d-flex align-items-center">{{editedTime.presidente?.nome}}
                                    <span class="material-symbols-outlined mini-botao-adicionar"
                                        (click)="openSwalModal(editedTime.id,'presidente')">
                                        add
                                    </span>
                            </div>
                            <hr>
                            <div class="mb=3">
                                <label class="form-label">Jogadores</label>
                                @for(jogador of editedTime!.jogadores; track jogador.id){
                                <p class="mb-2 d-flex align-items-center">{{jogador.nome}} <span
                                        class="material-symbols-outlined mini-botao-deletar"
                                        (click)="removerTimeJogador(jogador.id, editedTime.id)">
                                        delete_forever
                                    </span></p>
                                }
                                <span class="material-symbols-outlined mini-botao-adicionar"
                                    (click)="openSwalModal(editedTime.id,'jogador')">
                                    add
                                </span>
                            </div>
                            <hr>
                            <div class="mb-3">
                                <label for="nome" class="form-label">Nome</label>
                                <input type="text" class="form-control form-custom" id="nome"
                                    [(ngModel)]="editedTime!.nome">
                            </div>
                            <hr>
                            <div class="mb-3">
                                <label for="nome" class="form-label">Tipo de esporte</label>
                                <select class="form-select" [(ngModel)]="editedTime!.tipoEsporte">
                                    <option selected value="POLIESPORTIVA">Poliesportiva</option>
                                    <option value="BASQUETE">Basquete</option>
                                    <option value="FUTSAL">Futsal</option>
                                    <option value="VOLEI">Volei</option>
                                    <option value="TENIS">Tenis</option>
                                    <option value="HANDEBOL">Handebol</option>
                                    <option value="AREIA">Areia</option>
                                    <option value="SOCIETY">Society</option>
                                </select>
                            </div>
                            <hr>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn botao-salvar"><span class="material-symbols-outlined icone"
                            (click)="edit(selectedTime.id, editedTime)">
                            save
                        </span></button>
                    <button type="button" class="btn" (click)="closeModalEditTime(true)">Fechar</button>
                </div>
            </div>
        </div>
    </div>
</div>