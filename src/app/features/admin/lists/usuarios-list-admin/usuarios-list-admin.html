<link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0&icon_names=editdelete_foreverarrow_drop_downmysterysaveaddcancel" />

<div class="mt-5 text-center">
    <h2 class="fonte fonte-preta">Administrar usuários</h2>
</div>
<div class="custom-container h-50 overflow-auto">
    <div class="container-fluid mt-5 mb-5">
        <table class="table table-hover table-bordered border-color justify-content-center text-center">
            <thead>
                <tr>
                    <th scope="col" class="cor fonte">Nome</th>
                    <th scope="col" class="col-4 cor fonte">Email</th>
                    <th scope="col" class="cor fonte">Tipo de usuário</th>
                    <th scope="col" class="cor btn botao-adicionar"><span class="material-symbols-outlined"
                            (click)="openModalNewUser()">
                            add
                        </span></th>
                </tr>
            </thead>
            <tbody>
                @for(user of listaUsuarios; track user.id){
                <tr>
                    <td class="cor">{{user.nome}}</td>
                    <td class="cor">{{user.email}}</td>
                    <td class="cor">{{user.tipoUsuario}}</td>
                    <td class="cor icones">
                        <!--
                        <button type="button" class="btn botao-excluir"><span class="material-symbols-outlined icone">
                                delete_forever
                            </span></button> -->
                        <button type="button" class="btn botao-aumentar" (click)="openModal(user)"><span
                                class="material-symbols-outlined">
                                mystery
                            </span></button>
                    </td>
                </tr>

                }
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" #modalRef data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-xl modal-xl-custom">
        <div class="aumentar-tamanho">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="staticBackdropLabel">
                        <div class="fonte fonte-preta">Detalhes</div>
                    </h1>
                    <button type="button" class="btn-close" (click)="closeModal()"></button>
                </div>
                <div class="modal-body modal-body-scrollable">
                    <div class="container custom d-flex">
                        <div class="row custom">
                            <!-- data-bs-spy="scroll" data-bs-smooth-scroll="true" -->
                            <div class="col-3 border-end">
                                <p><strong>Cód:</strong> {{selectedUser.id}}</p>
                                <p><strong>Nome:</strong> {{selectedUser.nome}}</p>
                                <p><strong>Email:</strong> {{selectedUser.email}}</p>
                                <p><strong>Tipo de Usuário:</strong> {{selectedUser.tipoUsuario}}</p>
                                <button type="button" class="btn botao-editar m-1"><span
                                        class="material-symbols-outlined" (click)="openModalEditUser(selectedUser)">
                                        edit
                                    </span></button>
                                <button type="button" class="btn botao-excluir m-1"><span
                                        class="material-symbols-outlined" (click)="delete(selectedUser.id)">
                                        delete_forever
                                    </span></button>
                            </div>
                            <div class="col-4 border-end ">
                                <h5 class="fonte fonte-preta">Times presididos:</h5>
                                <hr>
                                <div class="h-50 overflow-auto">
                                    @for(time of selectedUser.timesProprietarios; track time.id){
                                    <div>
                                        <p><strong>Nome:</strong></p>
                                        <p>{{time.nome}}</p>
                                        <p><strong>Cód:</strong></p>
                                        <p>{{time.id}}</p>
                                        <p><strong>Tipo esporte:</strong></p>
                                        <p>{{time.tipoEsporte}}</p>
                                    </div>
                                    <hr>
                                    }
                                </div>
                            </div>
                            <div class="col-4 border-end overflow-auto">
                                <h5 class="fonte fonte-preta">Times jogados:</h5>
                                <hr>
                                <div class="h-50 overflow-auto">
                                    @for(time of selectedUser.times; track time.id){
                                    <div>
                                        <p><strong>Nome:</strong></p>
                                        <p>{{time.nome}}</p>
                                        <p><strong>Cód:</strong></p>
                                        <p>{{time.id}}</p>
                                        <p><strong>Tipo esporte:</strong></p>
                                        <p>{{time.tipoEsporte}}</p>
                                    </div>
                                    <hr>
                                    }
                                </div>
                            </div>
                            <div class="col-4 border-end overflow-auto">
                                <h5 class="fonte fonte-preta">Quadras:</h5>
                                <hr>
                                <div class="h-50 overflow-auto">
                                    @for(quadra of selectedUser.quadras; track quadra.id){
                                    <div>
                                        <p><strong>Nome:</strong></p>
                                        <p>{{quadra.nome}}</p>
                                        <p><strong>Cód:</strong></p>
                                        <p>{{quadra.id}}</p>
                                        <p><strong>Tipo esporte:</strong></p>
                                        <p>{{quadra.tipoQuadra}}</p>
                                    </div>
                                    <hr>
                                    }
                                </div>
                            </div>
                            <div class="col-4 h-50 overflow-auto">
                                <h5 class="fonte fonte-preta">Reservas:</h5>
                                <hr>
                                <div class="h-50 overflow-auto">
                                    @for(reserva of selectedUser.reservas; track reserva.id){
                                    <div>
                                        <p><strong>Horario:</strong></p>
                                        <p>{{reserva.horario?.horario}}</p>
                                        <p><strong>Cód:</strong></p>
                                        <p>{{reserva.id}}</p>
                                        <p><strong>Quadra:</strong></p>
                                        <p>{{reserva.quadra?.nome}}</p>
                                    </div>
                                    <hr>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" (click)="closeModal()">Fechar</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal novo usuário -->
<div class="modal fade" id="staticBackdrop" #modalRefNewUser data-bs-backdrop="static" data-bs-keyboard="false"
    tabindex="-1">
    <div class="modal-dialog modal-l">
        <div class="condensar">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="staticBackdropLabel">
                        <div class="fonte fonte-preta">Adicionar novo usuário</div>
                    </h1>
                    <!-- <button type="button" class="btn-close" (click)="closeModalNewUser()" aria-label="Close"></button> -->
                </div>
                <div class="m-2">
                    <label for="nome" class="form-label">Nome</label>
                    <input type="text" class="form-control" id="nome" [(ngModel)]="newUser!.nome">
                </div>
                <div class="m-2">
                    <label for="nome" class="form-label">Email</label>
                    <input type="text" class="form-control" id="email" type="email" [(ngModel)]="newUser!.email">
                </div>
                <div class="m-2">
                    <label for="nome" class="form-label">Tipo de usuario</label>
                    <select class="form-select" [(ngModel)]="newUser!.tipoUsuario">
                        <option selected value="COMUM">Comum</option>
                        <option value="ADMIN">Admin</option>
                    </select>
                </div>
                <div class="m-2">
                    <label for="nome" class="form-label">Senha</label>
                    <input type="text" class="form-control" id="senha" type="password" [(ngModel)]="newUser!.senha">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn botao-cancelar" (click)="closeModalNewUser()"><span
                            class="material-symbols-outlined ">
                            cancel
                        </span></button>

                    <button type="button" class="btn botao-salvar"><span class="material-symbols-outlined icone"
                            (click)="saveUser(newUser!)">
                            save
                        </span></button>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Modal editar usuário -->
<div class="modal fade" id="staticBackdrop" #ModalRefEditUser data-bs-backdrop="static" data-bs-keyboard="false"
    tabindex="-1">
    <div class="modal-dialog modal-l">
        <div class="aumentar-tamanho">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 id="staticBackdropLabel">
                        <div class="fonte fonte-preta">Editar usuário</div>
                    </h1>
                    <button type="button" class="btn-close" (click)="closeModalEditUser(true)"></button>
                </div>
                <div class="modal-body modal-body-scrollable h-25 overflow-auto">
                    <div class="container custom d-flex">
                        <div class="row custom-sm ">
                            <!-- data-bs-spy="scroll" data-bs-smooth-scroll="true" -->
                            <div class="mb=3">
                                <label class="form-label">Times presididos</label>
                                @for(time of editedUser!.timesProprietarios; track time.id){
                                <p class="mb-2 d-flex align-items-center">{{time.nome}} <span
                                        class="material-symbols-outlined mini-botao-deletar"
                                        (click)="removerTimePresidido(time.id)">
                                        delete_forever
                                    </span></p>
                                }
                                <span class="material-symbols-outlined mini-botao-adicionar"
                                (click)="openSwalModal(editedUser.id,'timesPresididos')">
                                    add
                                </span>
                            </div>
                            <hr>
                            <div class="mb=3">
                                <label class="form-label">Times jogados</label>
                                @for(time of editedUser!.times; track time.id){
                                <p class="mb-2 d-flex align-items-center">{{time.nome}} <span
                                        class="material-symbols-outlined mini-botao-deletar"
                                        (click)="removerTimeJogador(editedUser.id, time.id)">
                                        delete_forever
                                    </span></p>
                                }
                                <span class="material-symbols-outlined mini-botao-adicionar"
                                    (click)="openSwalModal(editedUser.id,'timesJogados')">
                                    add
                                </span>
                            </div>
                            <hr>
                            <div class="mb=3">
                                <label class="form-label">Quadras</label>
                                @for(quadra of editedUser!.quadras; track quadra.id){
                                <p class="mb-2 d-flex align-items-center">{{quadra.nome}} <span
                                        class="material-symbols-outlined mini-botao-deletar"
                                        (click)="removerQuadra(quadra.id)">
                                        delete_forever
                                    </span></p>
                                }
                                <span class="material-symbols-outlined mini-botao-adicionar">
                                    add
                                </span>
                            </div>
                            <hr>

                            <div class="mb-3">
                                <label for="nome" class="form-label">Nome</label>
                                <input type="text" class="form-control form-custom" id="nome"
                                    [(ngModel)]="editedUser!.nome">
                            </div>
                            <hr>
                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control form-custom" id="email"
                                    [(ngModel)]="editedUser!.email">
                            </div>
                            <hr>
                            <div class="mb-3">
                                <label for="tipoUsuario" class="form-label">Tipo de usuario</label>
                                <select class="form-select" [(ngModel)]="editedUser!.tipoUsuario">
                                    <option selected value="COMUM">Comum</option>
                                    <option value="ADMIN">Admin</option>
                                </select>
                            </div>
                            <hr>
                            <div class="mb-3">
                                <label for="senha" class="form-label">Senha</label>
                                <input type="password" class="form-control form-custom" id="senha" value=null
                                    [(ngModel)]="editedUser!.senha">
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn botao-salvar"><span class="material-symbols-outlined icone"
                            (click)="edit(selectedUser.id, editedUser)">
                            save
                        </span></button>
                    <button type="button" class="btn" (click)="closeModalEditUser(true)">Fechar</button>
                </div>
            </div>
        </div>
    </div>
</div>